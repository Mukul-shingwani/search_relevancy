<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Search Assortment — automotive / vacuum_cleaners</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Fonts: Proxima Nova if installed, else Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- DataTables + Buttons -->
  <link rel="stylesheet" href="https://cdn.datatables.net/v/bs5/dt-2.0.3/b-3.0.1/fh-4.0.1/r-3.0.1/datatables.min.css"/>

  <style>
    :root {
      --bg: #0f1220;
      --card: #141a2a;
      --card-2: #181e31;
      --text: #f3f6ff;     /* normal text = light */
      --text-dim: #b8c1d9;
      --border: #252c42;
      --brand: #7aa2ff;
      --brand-soft: #1a2340;
      --card-radius: 14px;
    }
    * { font-family: "Proxima Nova", Inter, "Segoe UI", Roboto, system-ui, -apple-system, Arial, sans-serif; }
    html, body { background: var(--bg); color: var(--text); }

    .page-header {
      background: radial-gradient(1200px 400px at 10% -10%, rgba(122,162,255,.25), transparent),
                  linear-gradient(90deg, var(--brand-soft), rgba(10,14,25,0.6));
      border-bottom: 1px solid var(--border);
    }
    .page-header h2 { font-weight: 700; letter-spacing:.2px; color: var(--text); }
    .muted { color: var(--text-dim); }

    .btn, .btn:focus, .btn:active { box-shadow:none; }
    .btn-outline-secondary { color: var(--text); border-color: var(--border); }
    .btn-outline-secondary:hover { background: var(--card-2); border-color: var(--border); }
    .btn-outline-primary { color: var(--text); border-color: var(--brand); }
    .btn-outline-primary:hover { background: rgba(122,162,255,.12); }

    .section-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--card-radius);
      box-shadow: 0 8px 24px rgba(0,0,0,.25);
      padding: 1rem 1.1rem 1.25rem 1.1rem;
      height: 100%;
      contain: content;
      color: var(--text);
    }
    .section-title { font-weight: 700; font-size: 1.05rem; margin-bottom:.6rem; color: var(--text); }

    /* Executive summary pills */
    .summary-pill {
      border-radius: 999px;
      padding:.7rem 1.1rem;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border);
      display:inline-flex; gap:.6rem; align-items:center;
      box-shadow: 0 6px 16px rgba(0,0,0,.25);
      margin:.3rem .6rem .3rem 0;
    }
    .summary-pill .label { color: var(--text-dim); font-size:.9rem; }
    .summary-pill .value { font-weight:700; color: var(--text); font-size:1.05rem; }

    /* DataTables: dark + light text everywhere */
    table.dataTable { table-layout: fixed; color: var(--text); }
    table.table {
      --bs-table-color: var(--text);
      --bs-table-bg: transparent;
      --bs-table-striped-color: var(--text);
      --bs-table-hover-color: var(--text);
      --bs-table-border-color: var(--border);
      --bs-table-striped-bg: rgba(255,255,255,0.06);
      --bs-table-hover-bg: rgba(255,255,255,0.08);
    }
    table.dataTable thead th {
      background: var(--card-2) !important;
      border-bottom: 1px solid var(--border) !important;
      color: var(--text) !important;
    }
    table.dataTable tbody td { vertical-align: top; border-color: var(--border); color: var(--text); }

    .dataTables_wrapper .dataTables_info,
    .dataTables_wrapper .dataTables_length label,
    .dataTables_wrapper .dataTables_filter label { color: var(--text-dim); }

    .dataTables_wrapper .dataTables_filter input,
    .dataTables_wrapper .dataTables_length select {
      background: var(--card-2);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
    }
    .dataTables_wrapper .dataTables_filter input::placeholder { color: var(--text-dim); }

    .dataTables_wrapper .dataTables_paginate .paginate_button {
      color: var(--text) !important; border-color: var(--border) !important;
      background: transparent !important;
    }
    .dataTables_wrapper .dataTables_paginate .paginate_button.current {
      background: var(--brand-soft) !important; border-color: var(--border) !important; color: var(--text) !important;
    }

    a, a:visited { color: var(--brand); }
    a:hover { color: #aecdff; }

    /* Long text handling + toggles */
    .wrap-text { white-space: pre-wrap; line-height:1.35rem; color: var(--text); }
    .clamp-6 {
      display: -webkit-box;
      -webkit-line-clamp: 6;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .cell-stack { display:flex; flex-direction:column; gap:.45rem; color: var(--text); }
    .toggle-more { font-size:.85rem; padding:0; color: var(--text-dim); }
    .toggle-more:hover { color: var(--text); }

    /* Actionables list (pills centered vertically) */
    .act {
      display:flex; gap:.7rem; align-items:center;       /* centered vertically */
      background: var(--card-2); border: 1px solid var(--border);
      border-radius: 12px; padding:.65rem .8rem; color: var(--text);
    }
    .act .tag {
      flex: 0 0 auto; font-size:.72rem; font-weight:700; text-transform:uppercase;
      letter-spacing:.04em; color: var(--brand);
      padding:.22rem .55rem; border:1px solid var(--brand); border-radius:999px;
      background: rgba(122,162,255,.08);
    }
    .act .txt { flex:1 1 auto; color: var(--text); }

    .footer-note { color: var(--text-dim); font-size:.85rem; }
  </style>
</head>

<body>
  <header class="page-header py-3">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-between">
        <div>
          <h2 class="mb-0">Search Assortment — automotive / vacuum_cleaners</h2>
          <div class="muted">Category: <strong>automotive</strong> &nbsp;|&nbsp; Subtype: <strong>vacuum_cleaners</strong></div>
        </div>
        <div class="text-end">
          <a class="btn btn-outline-secondary btn-sm" href="#" onclick="window.print()">Print</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container my-4">

    <!-- Executive Summary -->
    <div class="section-card mb-4">
      <div class="d-flex align-items-center flex-wrap">
        <div class="summary-pill"><span class="label">Overall Score</span><span class="value" id="pill-score">—</span></div>
        <div class="summary-pill"><span class="label">Overall Search Hits</span><span class="value" id="pill-hits">—</span></div>
        <div class="summary-pill"><span class="label">Overall GMV Opportunity</span><span class="value" id="pill-gmv">—</span></div>
        <div class="ms-auto muted">Generated on 09 Sep 2025, 08:09 PM</div>
      </div>
    </div>

    <!-- Keyword level insights -->
    <div class="row g-4">
      <div class="col-lg-6">
        <div class="section-card">
          <div class="section-title">Keyword Insights — Generic</div>
          <table id="tbl-generic" class="table table-striped table-hover w-100"></table>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="section-card">
          <div class="section-title">Keyword Insights — Branded</div>
          <table id="tbl-branded" class="table table-striped table-hover w-100"></table>
        </div>
      </div>
    </div>

    <!-- Detailed analysis -->
    <div class="section-card mt-4">
      <div class="d-flex justify-content-between align-items-center">
        <div class="section-title mb-0">Detailed Analysis</div>
        <div class="d-flex gap-2">
          <button id="btn-expand-all" class="btn btn-sm btn-outline-primary">Expand all</button>
          <button id="btn-collapse-all" class="btn btn-sm btn-outline-secondary">Collapse all</button>
        </div>
      </div>
      <p class="muted mb-2">Actionables per search term. Links open in a new tab.</p>
      <table id="tbl-detail" class="table table-striped table-hover w-100"></table>
    </div>

    <div class="my-4 footer-note">
      Data source: <code>noonbiml.mukul.search_assortment_final_v2</code>. Report for <strong>automotive × vacuum_cleaners</strong>.
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/v/bs5/dt-2.0.3/b-3.0.1/fh-4.0.1/r-3.0.1/datatables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
    const EXEC_SUMMARY = {"overall_score": 0.89, "overall_st_hits": 6873, "overall_gmv_oppt": 53199.96};
    const DATA_GENERIC = [{"search_term": "portable vacuum", "performance": "Good (0.94)", "st_hits": 56, "e_gmv": 0, "st_gmv": 99.6}, {"search_term": "handheld vacuum", "performance": "Good (0.91)", "st_hits": 734, "e_gmv": 0, "st_gmv": 2344.11}, {"search_term": "cordless vacuum", "performance": "Good (0.93)", "st_hits": 0, "e_gmv": 0, "st_gmv": 0.0}, {"search_term": "car vacuum cleaner wireless", "performance": "Good (0.94)", "st_hits": 181, "e_gmv": 0, "st_gmv": 403.22}, {"search_term": "upholstery cleaner", "performance": "Good (0.93)", "st_hits": 105, "e_gmv": 0, "st_gmv": 457.91}, {"search_term": "car vacuum", "performance": "Good (0.91)", "st_hits": 0, "e_gmv": 0, "st_gmv": 0.0}, {"search_term": "car vacuum cleaner portable", "performance": "Good (0.93)", "st_hits": 1717, "e_gmv": 0, "st_gmv": 3341.82}, {"search_term": "car vacuum cleaner", "performance": "Good (0.93)", "st_hits": 778, "e_gmv": 0, "st_gmv": 1500.26}, {"search_term": "vacuum cleaner for car", "performance": "Good (0.93)", "st_hits": 0, "e_gmv": 0, "st_gmv": 0.0}, {"search_term": "air duster", "performance": "Excellent (0.96)", "st_hits": 150, "e_gmv": 0, "st_gmv": 858.17}];
    const DATA_BRANDED = [{"search_term": "dyson vacuum", "performance": "Below Average (0.71)", "st_hits": 2081, "e_gmv": 0, "st_gmv": 28765.15}, {"search_term": "shark vacuum", "performance": "Average (0.89)", "st_hits": 165, "e_gmv": 0, "st_gmv": 1998.04}, {"search_term": "xiaomi vacuum", "performance": "Average (0.87)", "st_hits": 245, "e_gmv": 0, "st_gmv": 4392.57}, {"search_term": "hoover vacuum", "performance": "Average (0.90)", "st_hits": 615, "e_gmv": 0, "st_gmv": 3352.02}, {"search_term": "bissell vacuum", "performance": "Average (0.90)", "st_hits": 46, "e_gmv": 0, "st_gmv": 0.0}];
    const DATA_DETAIL  = [{"search_term": "dyson vacuum", "brand_actionable": "- Dyson dominates both platforms; Noon lists 10 Dyson SKUs vs Amazon’s 10, but Noon lacks renewed/refurbished variants.  \n- Noon misses Dyson Gen5 Detect and Wash G1 models present on Amazon.", "assortment_actionable": "- Noon ranks core Dyson V8, V10, V11, V15 models top but lacks newer Gen5 and refurbished options Amazon shows.", "overall_perception": "- Noon’s first page shows strong Dyson presence but fewer premium/renewed variants; Amazon offers broader, trust-building Dyson lineup.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=dyson%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=dyson+vacuum"}, {"search_term": "shark vacuum", "brand_actionable": "- Noon features 9 Shark-related models prominently vs 2 on Amazon, showing strong brand presence.  \n- Amazon includes diverse vacuum brands (e.g., WV201BK, Steam PickUp) absent on Noon, limiting brand variety.", "assortment_actionable": "- Noon ranks multiple Shark premium cordless models top, Amazon mixes Shark with budget and niche variants.", "overall_perception": "- Noon’s first page is Shark-focused, premium, and relevant; Amazon shows broader, mixed-brand budget and specialty vacuums.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=shark%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=shark+vacuum"}, {"search_term": "xiaomi vacuum", "brand_actionable": "- Xiaomi dominates Noon with 10 SKUs vs 9 on Amazon, but Noon lacks some Xiaomi submodels like E5 and X20 Pro present on Amazon.  \n- Noon misses Xiaomi Mini variant ranking top on Amazon, reducing brand variant visibility.", "assortment_actionable": "- Noon’s top ranks favor premium Xiaomi models but miss mid-tier variants like Xiaomi E5 and Mini, which Amazon places prominently.", "overall_perception": "- Noon’s first page emphasizes high-end Xiaomi vacuums; Amazon balances premium and budget Xiaomi models, enhancing shopper trust and choice.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=xiaomi%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=xiaomi+vacuum"}, {"search_term": "hoover vacuum", "brand_actionable": "- Noon covers key cordless Hoover models but lacks variety in handheld and multi-surface types Amazon offers.  \n- Hoover-branded cordless vacuums appear prominently on both, but Amazon lists more variants and colors.", "assortment_actionable": "- Noon ranks cordless stick vacuums top but misses deeper handheld and specialty vacuum variants Amazon shows early.", "overall_perception": "- Noon’s first page mixes premium cordless and bulky drum vacuums, while Amazon leads with focused, relevant Hoover cordless and multi-use models.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=hoover%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=hoover+vacuum"}, {"search_term": "bissell vacuum", "brand_actionable": "- Noon shows BISSELL prominently but with fewer SKUs (6 vs 9 on Amazon).  \n- Amazon includes more BISSELL variants and a unique COMFEE model absent on Noon.", "assortment_actionable": "- Noon lacks top-tier BISSELL models like MultiClean Turbo Drum and Pet Hair Eraser in top ranks.", "overall_perception": "- Noon’s first page mixes premium and budget BISSELL models but Amazon leads with broader, feature-rich, and more relevant BISSELL options.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=bissell%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=bissell+vacuum"}, {"search_term": "portable vacuum", "brand_actionable": "- Noon covers 3/6 top Amazon brands (50%), missing BLACK+DECKER and Xiaomi presence.  \n- Amazon features BLACK+DECKER prominently (4 listings), Noon only 1, reducing brand trust for branded searches.", "assortment_actionable": "- Noon ranks mostly generic portable vacuums; Amazon leads with diverse feature-rich, branded models in top slots.", "overall_perception": "- Noon’s first page skews budget and generic; Amazon offers premium, branded, and highly relevant portable vacuums upfront.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=portable%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=portable+vacuum"}, {"search_term": "handheld vacuum", "brand_actionable": "- Noon covers 4/10 Amazon brands (40%), missing Black & Decker and Kenwood presence.  \n- Black & Decker appears once on Noon vs 4 times on Amazon, limiting brand trust.", "assortment_actionable": "- Noon lacks premium, feature-rich handheld vacuums in top slots; Amazon ranks multiple high-suction, cordless models prominently.", "overall_perception": "- Noon’s first page mixes budget and generic models; Amazon leads with well-known, high-performance branded handheld vacuums, boosting shopper confidence.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=handheld%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=handheld+vacuum"}, {"search_term": "cordless vacuum", "brand_actionable": "- Noon covers Xiaomi and MI but misses Dyson and Shark, key cordless vacuum brands present on Amazon.  \n- Noon features 3/10 top Amazon brands (30%), limiting premium brand variety.", "assortment_actionable": "- Noon lacks high-end models like Dyson V8 and Shark in top ranks, focusing more on mid-range variants.", "overall_perception": "- Noon’s first page leans mid-budget, less premium; Amazon leads with top-tier, feature-rich cordless vacuums building shopper trust.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=cordless%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=cordless+vacuum"}, {"search_term": "car vacuum cleaner wireless", "brand_actionable": "- Noon lacks BLACK+DECKER and Xiaomi presence, key brands on Amazon.  \n- Noon covers 3/7 top Amazon brands (43%), missing premium brushless motor models.", "assortment_actionable": "- Noon ranks mostly generic wireless vacuums; Amazon features diverse brushless, multi-function, and branded variants top-ranked.", "overall_perception": "- Noon’s first page shows budget, generic cordless vacuums; Amazon leads with premium, feature-rich, branded wireless car vacuums.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20vacuum%20cleaner%20wireless&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=car+vacuum+cleaner+wireless"}, {"search_term": "upholstery cleaner", "brand_actionable": "- Noon covers 3 key brands (Hoover, Cleanslate, Powerful) vs Amazon’s 5 including Vanish, Astonish, missing on Noon.  \n- Hoover appears twice top on both, but Vanish and Astonish absent on Noon’s first page.", "assortment_actionable": "- Amazon ranks multiple branded stain removers and machine variants top; Noon’s top slots mix machines and generic cleaners, lacking multipacks and diverse formulas.", "overall_perception": "- Noon’s first page blends budget and premium but includes generic cleaners, while Amazon leads with recognized brands and specialized upholstery cleaners.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=upholstery%20cleaner&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=upholstery+cleaner"}, {"search_term": "car vacuum", "brand_actionable": "- Noon lacks major brands like BLACK+DECKER and Fanttik present on Amazon.  \n- Noon covers mostly generic/no-brand SKUs; Amazon features 4 top brands prominently.", "assortment_actionable": "- Noon ranks mostly generic cordless handheld vacuums; Amazon offers diverse power levels, brand models, and multi-function variants top-ranked.", "overall_perception": "- Noon’s first page is budget-focused, generic; Amazon leads with premium, branded, feature-rich car vacuums enhancing shopper trust.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20vacuum&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=car+vacuum"}, {"search_term": "car vacuum cleaner portable", "brand_actionable": "- Noon covers 3/6 top Amazon brands (50%), missing Black+Decker and ThisWorx presence.  \n- Amazon features stronger branded variety with premium names; Noon leans on generics.", "assortment_actionable": "- Noon lacks top-tier branded, feature-rich models in top ranks, unlike Amazon’s premium-focused first page.", "overall_perception": "- Noon’s first page mixes budget generics and mid-tier; Amazon leads with trusted, high-power branded vacuums.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20vacuum%20cleaner%20portable&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=car+vacuum+cleaner+portable"}, {"search_term": "car vacuum cleaner", "brand_actionable": "- Noon covers 3/6 top Amazon brands (50%), missing Black+Decker’s prominent models found on Amazon’s top ranks.  \n- Key brands like ThisWorx and LENND absent on Noon, limiting premium brand variety.", "assortment_actionable": "- Noon’s top ranks favor generic cordless models; Amazon features diverse power levels and multi-function vacuums with detailed accessories.", "overall_perception": "- Noon’s first page skews budget and generic; Amazon leads with branded, feature-rich, and highly relevant car vacuum cleaners, enhancing shopper trust.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20vacuum%20cleaner&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=car+vacuum+cleaner"}, {"search_term": "vacuum cleaner for car", "brand_actionable": "- Noon covers 3/6 top Amazon brands (50%), missing Black+Decker’s strong presence and variety.  \n- Black+Decker appears 3x on Amazon vs 1x on Noon, indicating weaker brand prominence on Noon.", "assortment_actionable": "- Noon ranks more budget, generic cordless vacuums; Amazon features diverse high-power, branded, and multifunctional models top-ranked.", "overall_perception": "- Noon’s first page skews budget and less feature-rich; Amazon leads with premium, brand-focused, and highly relevant car vacuum cleaners.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=vacuum%20cleaner%20for%20car&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=vacuum+cleaner+for+car"}, {"search_term": "air duster", "brand_actionable": "- Noon covers 4/9 top Amazon brands (~44%), missing WOLFBOX and ZARIMI, which dominate Amazon’s premium segment.  \n- Noon lacks presence of high-capacity battery brands like AURTEC and ddLUCK featured on Amazon.", "assortment_actionable": "- Noon ranks mostly mid-range electric air dusters; Amazon leads with broader speed, battery capacity, and multi-function variants in top slots.", "overall_perception": "- Noon’s first page mixes budget and mid-tier models; Amazon emphasizes premium, feature-rich, and high-RPM dusters, building stronger shopper trust.", "noon_plp_link": "https://www.noon.com/uae-en/search/?q=air%20duster&av=0&e[search-ae]", "amazon_plp_link": "https://www.amazon.ae/s?k=air+duster"}];

    const fmtInt = (v) => (v === null || v === undefined || isNaN(v)) ? "—" : Number(v).toLocaleString();
    const fmtNum = (v) => (v === null || v === undefined || isNaN(v)) ? "—" : Number(v).toLocaleString(undefined, {"minimumFractionDigits":0,"maximumFractionDigits":2});
    const toLink = (url, label) => {
      if (!url || typeof url !== 'string') return '';
      const safe = url.startsWith('http') ? url : null;
      return safe ? `<a href="${safe}" target="_blank" rel="noopener">${label || 'Open'}</a>` : '';
    };
    const escapeHTML = (s) => String(s ?? '').replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]);

    // Single "Actionables" cell from 3 fields
    const makeActionablesCell = (row) => {
      const items = [];
      if (row.brand_actionable) items.push(`<div class="act"><div class="tag">Brand</div><div class="txt wrap-text">${escapeHTML(row.brand_actionable)}</div></div>`);
      if (row.assortment_actionable) items.push(`<div class="act"><div class="tag">Assortment</div><div class="txt wrap-text">${escapeHTML(row.assortment_actionable)}</div></div>`);
      if (row.overall_perception) items.push(`<div class="act"><div class="tag">Perception</div><div class="txt wrap-text">${escapeHTML(row.overall_perception)}</div></div>`);

      const content = items.join('');
      const long = content.length > 300 || (content.match(/\n/g)||[]).length > 6;
      const btn  = long ? `<a href="#" class="toggle-more">Show more</a>` : '';
      return `<div class="cell-stack"><div class="wrap-text clamp-6">${content}</div>${btn}</div>`;
    };

    document.addEventListener('DOMContentLoaded', () => {
      // Executive summary values
      document.getElementById('pill-score').textContent = EXEC_SUMMARY.overall_score ?? "—";
      document.getElementById('pill-hits').textContent  = fmtInt(EXEC_SUMMARY.overall_st_hits);
      document.getElementById('pill-gmv').textContent   = fmtNum(EXEC_SUMMARY.overall_gmv_oppt);

      // Generic table
      $('#tbl-generic').DataTable({
        data: DATA_GENERIC,
        columns: [
          {title:'Search Term', data:'search_term'},
          {title:'Performance', data:'performance'},
          {title:'Search Hits', data:'st_hits', render:(d)=>fmtInt(d), className:'text-end'},
          {title:'Search Term GMV', data:'st_gmv', render:(d)=>fmtNum(d), className:'text-end'}
        ],
        order: [[2,'desc']],
        responsive: true,
        fixedHeader: false,
        deferRender: true,
        autoWidth: false,
        pageLength: 10,
        lengthMenu: [10,25,50,100],
        dom:'Bfrtip',
        buttons:['pageLength','copy','csv']
      });

      // Branded table
      $('#tbl-branded').DataTable({
        data: DATA_BRANDED,
        columns: [
          {title:'Search Term', data:'search_term'},
          {title:'Performance', data:'performance'},
          {title:'Search Hits', data:'st_hits', render:(d)=>fmtInt(d), className:'text-end'},
          {title:'Search Term GMV', data:'st_gmv', render:(d)=>fmtNum(d), className:'text-end'}
        ],
        order: [[2,'desc']],
        responsive: true,
        fixedHeader: false,
        deferRender: true,
        autoWidth: false,
        pageLength: 10,
        lengthMenu: [10,25,50,100],
        dom:'Bfrtip',
        buttons:['pageLength','copy','csv']
      });

      // Detailed Analysis
      const dtDetail = $('#tbl-detail').DataTable({
        data: DATA_DETAIL,
        columns: [
          {title:'Search Term', data:'search_term', width:'18%'},
          {title:'Actionables', data:null, width:'56%', render:(d,type,row)=>makeActionablesCell(row)},
          {title:'Noon PLP', data:'noon_plp_link', width:'13%', render:(d)=>toLink(d,'Noon PLP')},
          {title:'Amazon PLP', data:'amazon_plp_link', width:'13%', render:(d)=>toLink(d,'Amazon PLP')}
        ],
        order: [[0,'asc']],
        responsive: false,
        fixedHeader: false,
        deferRender: true,
        autoWidth: false,
        pageLength: 10,
        lengthMenu: [10,25,50,100],
        dom:'Bfrtip',
        buttons:['pageLength','copy','csv']
      });

      // Per-cell toggle
      $('#tbl-detail').on('click', 'a.toggle-more', function(e){
        e.preventDefault();
        const wrap = this.closest('td').querySelector('.wrap-text');
        if (wrap.classList.contains('clamp-6')) {
          wrap.classList.remove('clamp-6');
          this.textContent = 'Show less';
        } else {
          wrap.classList.add('clamp-6');
          this.textContent = 'Show more';
        }
      });

      // Expand/collapse all
      document.getElementById('btn-expand-all').addEventListener('click', () => {
        document.querySelectorAll('#tbl-detail .wrap-text').forEach(el => el.classList.remove('clamp-6'));
        document.querySelectorAll('#tbl-detail a.toggle-more').forEach(a => a.textContent='Show less');
      });
      document.getElementById('btn-collapse-all').addEventListener('click', () => {
        document.querySelectorAll('#tbl-detail .wrap-text').forEach(el => el.classList.add('clamp-6'));
        document.querySelectorAll('#tbl-detail a.toggle-more').forEach(a => a.textContent='Show more');
      });
    });
  </script>
</body>
</html>
